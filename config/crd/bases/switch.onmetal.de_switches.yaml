---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.3
  creationTimestamp: null
  name: switches.switch.onmetal.de
spec:
  group: switch.onmetal.de
  names:
    kind: Switch
    listKind: SwitchList
    plural: switches
    shortNames:
    - sw
    singular: switch
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Switch ASN
      jsonPath: .status.asn
      name: ASN
      type: integer
    - description: Number of switch ports
      jsonPath: .status.switchPorts
      name: Ports
      type: integer
    - description: Switch's role
      jsonPath: .status.role
      name: Role
      type: string
    - description: Vertical level in switches' connections hierarchy
      jsonPath: .status.layer
      name: Layer
      type: integer
    - description: Switch state
      jsonPath: .status.state
      name: State
      type: string
    - description: Switch state message reports about any issues during processing
      jsonPath: .status.message
      name: Message
      priority: 1
      type: string
    name: v1beta1
    schema:
      openAPIV3Schema:
        description: Switch is the Schema for switches API.
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: SwitchSpec contains desired state of resulting Switch configuration
            properties:
              configSelector:
                description: ConfigSelector contains selector to filter out corresponding
                  SwitchConfig. If the selector is not defined, it will be populated
                  by defaulting webhook with MatchLabels item, containing 'switch.onmetal.de/layer'
                  key with value equals to object's .status.layer.
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements.
                      The requirements are ANDed.
                    items:
                      description: A label selector requirement is a selector that
                        contains values, a key, and an operator that relates the key
                        and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies
                            to.
                          type: string
                        operator:
                          description: operator represents a key's relationship to
                            a set of values. Valid operators are In, NotIn, Exists
                            and DoesNotExist.
                          type: string
                        values:
                          description: values is an array of string values. If the
                            operator is In or NotIn, the values array must be non-empty.
                            If the operator is Exists or DoesNotExist, the values
                            array must be empty. This array is replaced during a strategic
                            merge patch.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                  matchLabels:
                    additionalProperties:
                      type: string
                    description: matchLabels is a map of {key,value} pairs. A single
                      {key,value} in the matchLabels map is equivalent to an element
                      of matchExpressions, whose key field is "key", the operator
                      is "In", and the values array contains only "value". The requirements
                      are ANDed.
                    type: object
                type: object
                x-kubernetes-map-type: atomic
              cordon:
                default: false
                description: Cordon is a flag defining whether Switch object is taken
                  offline
                type: boolean
              interfaces:
                description: Interfaces contains general configuration for all switch
                  ports
                properties:
                  defaults:
                    description: Defaults contains switch port parameters which will
                      be applied to all ports of the switches
                    properties:
                      fec:
                        description: FEC refers to forward error correction method
                          which should be applied on switch port
                        enum:
                        - rs
                        - none
                        type: string
                      ipv4MaskLength:
                        description: IPv4MaskLength defines prefix of subnet where
                          switch port's IPv4 address should be reserved
                        format: int32
                        maximum: 32
                        minimum: 1
                        type: integer
                      ipv6Prefix:
                        description: IPv6Prefix defines prefix of subnet where switch
                          port's IPv6 address should be reserved
                        format: int32
                        maximum: 128
                        minimum: 1
                        type: integer
                      lanes:
                        description: Lanes refers to a number of lanes used by switch
                          port
                        format: int32
                        maximum: 8
                        minimum: 1
                        type: integer
                      mtu:
                        description: MTU refers to maximum transmission unit value
                          which should be applied on switch port
                        format: int32
                        maximum: 65535
                        minimum: 84
                        type: integer
                      state:
                        description: State defines default state of switch port
                        enum:
                        - up
                        - down
                        type: string
                    type: object
                  overrides:
                    description: Overrides contains set of parameters which should
                      be overridden for listed switch ports
                    items:
                      description: InterfaceOverridesSpec contains overridden parameters
                        for certain switch port
                      properties:
                        fec:
                          description: FEC refers to forward error correction method
                            which should be applied on switch port
                          enum:
                          - rs
                          - none
                          type: string
                        ip:
                          description: IP contains a list of additional IP addresses
                            for interface
                          items:
                            description: AdditionalIPSpec defines IP address and selector
                              for subnet where address should be reserved
                            properties:
                              address:
                                description: Address contains additional IP address
                                  that should be assigned to the interface
                                type: string
                              parentSubnet:
                                description: ParentSubnet contains label selector
                                  to pick up IPAM objects
                                properties:
                                  matchExpressions:
                                    description: matchExpressions is a list of label
                                      selector requirements. The requirements are
                                      ANDed.
                                    items:
                                      description: A label selector requirement is
                                        a selector that contains values, a key, and
                                        an operator that relates the key and values.
                                      properties:
                                        key:
                                          description: key is the label key that the
                                            selector applies to.
                                          type: string
                                        operator:
                                          description: operator represents a key's
                                            relationship to a set of values. Valid
                                            operators are In, NotIn, Exists and DoesNotExist.
                                          type: string
                                        values:
                                          description: values is an array of string
                                            values. If the operator is In or NotIn,
                                            the values array must be non-empty. If
                                            the operator is Exists or DoesNotExist,
                                            the values array must be empty. This array
                                            is replaced during a strategic merge patch.
                                          items:
                                            type: string
                                          type: array
                                      required:
                                      - key
                                      - operator
                                      type: object
                                    type: array
                                  matchLabels:
                                    additionalProperties:
                                      type: string
                                    description: matchLabels is a map of {key,value}
                                      pairs. A single {key,value} in the matchLabels
                                      map is equivalent to an element of matchExpressions,
                                      whose key field is "key", the operator is "In",
                                      and the values array contains only "value".
                                      The requirements are ANDed.
                                    type: object
                                type: object
                                x-kubernetes-map-type: atomic
                            type: object
                          type: array
                        ipv4MaskLength:
                          description: IPv4MaskLength defines prefix of subnet where
                            switch port's IPv4 address should be reserved
                          format: int32
                          maximum: 32
                          minimum: 1
                          type: integer
                        ipv6Prefix:
                          description: IPv6Prefix defines prefix of subnet where switch
                            port's IPv6 address should be reserved
                          format: int32
                          maximum: 128
                          minimum: 1
                          type: integer
                        lanes:
                          description: Lanes refers to a number of lanes used by switch
                            port
                          format: int32
                          maximum: 8
                          minimum: 1
                          type: integer
                        mtu:
                          description: MTU refers to maximum transmission unit value
                            which should be applied on switch port
                          format: int32
                          maximum: 65535
                          minimum: 84
                          type: integer
                        name:
                          description: Name refers to switch port name
                          type: string
                        state:
                          description: State defines default state of switch port
                          enum:
                          - up
                          - down
                          type: string
                      type: object
                    type: array
                type: object
              inventoryRef:
                description: InventoryRef contains reference to corresponding inventory
                  object Empty InventoryRef means that there is no corresponding Inventory
                  object
                properties:
                  name:
                    description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                    type: string
                type: object
                x-kubernetes-map-type: atomic
              ipam:
                description: IPAM refers to selectors for subnets which will be used
                  for Switch object
                properties:
                  loopbackAddresses:
                    description: LoopbackAddresses defines selector for IP object
                      which will be assigned to switch's loopback interface
                    properties:
                      fieldSelector:
                        description: FieldSelector contains label key and field path
                          where to get label value for search. If FieldSelector is
                          used as part of IPAM configuration in SwitchConfig object
                          it will reference to the field path in related Switch object.
                          If FieldSelector is used as part of IPAM configuration in
                          Switch object, it will reference to the field path in the
                          same object
                        properties:
                          fieldRef:
                            description: FieldRef contains reference to the field
                              of resource where to get label's value
                            properties:
                              apiVersion:
                                description: Version of the schema the FieldPath is
                                  written in terms of, defaults to "v1".
                                type: string
                              fieldPath:
                                description: Path of the field to select in the specified
                                  API version.
                                type: string
                            required:
                            - fieldPath
                            type: object
                            x-kubernetes-map-type: atomic
                          labelKey:
                            description: LabelKey contains label key
                            type: string
                        type: object
                      labelSelector:
                        description: LabelSelector contains label selector to pick
                          up IPAM objects
                        properties:
                          matchExpressions:
                            description: matchExpressions is a list of label selector
                              requirements. The requirements are ANDed.
                            items:
                              description: A label selector requirement is a selector
                                that contains values, a key, and an operator that
                                relates the key and values.
                              properties:
                                key:
                                  description: key is the label key that the selector
                                    applies to.
                                  type: string
                                operator:
                                  description: operator represents a key's relationship
                                    to a set of values. Valid operators are In, NotIn,
                                    Exists and DoesNotExist.
                                  type: string
                                values:
                                  description: values is an array of string values.
                                    If the operator is In or NotIn, the values array
                                    must be non-empty. If the operator is Exists or
                                    DoesNotExist, the values array must be empty.
                                    This array is replaced during a strategic merge
                                    patch.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - key
                              - operator
                              type: object
                            type: array
                          matchLabels:
                            additionalProperties:
                              type: string
                            description: matchLabels is a map of {key,value} pairs.
                              A single {key,value} in the matchLabels map is equivalent
                              to an element of matchExpressions, whose key field is
                              "key", the operator is "In", and the values array contains
                              only "value". The requirements are ANDed.
                            type: object
                        type: object
                        x-kubernetes-map-type: atomic
                    type: object
                  southSubnets:
                    description: SouthSubnets defines selector for subnet object which
                      will be assigned to switch
                    properties:
                      fieldSelector:
                        description: FieldSelector contains label key and field path
                          where to get label value for search. If FieldSelector is
                          used as part of IPAM configuration in SwitchConfig object
                          it will reference to the field path in related Switch object.
                          If FieldSelector is used as part of IPAM configuration in
                          Switch object, it will reference to the field path in the
                          same object
                        properties:
                          fieldRef:
                            description: FieldRef contains reference to the field
                              of resource where to get label's value
                            properties:
                              apiVersion:
                                description: Version of the schema the FieldPath is
                                  written in terms of, defaults to "v1".
                                type: string
                              fieldPath:
                                description: Path of the field to select in the specified
                                  API version.
                                type: string
                            required:
                            - fieldPath
                            type: object
                            x-kubernetes-map-type: atomic
                          labelKey:
                            description: LabelKey contains label key
                            type: string
                        type: object
                      labelSelector:
                        description: LabelSelector contains label selector to pick
                          up IPAM objects
                        properties:
                          matchExpressions:
                            description: matchExpressions is a list of label selector
                              requirements. The requirements are ANDed.
                            items:
                              description: A label selector requirement is a selector
                                that contains values, a key, and an operator that
                                relates the key and values.
                              properties:
                                key:
                                  description: key is the label key that the selector
                                    applies to.
                                  type: string
                                operator:
                                  description: operator represents a key's relationship
                                    to a set of values. Valid operators are In, NotIn,
                                    Exists and DoesNotExist.
                                  type: string
                                values:
                                  description: values is an array of string values.
                                    If the operator is In or NotIn, the values array
                                    must be non-empty. If the operator is Exists or
                                    DoesNotExist, the values array must be empty.
                                    This array is replaced during a strategic merge
                                    patch.
                                  items:
                                    type: string
                                  type: array
                              required:
                              - key
                              - operator
                              type: object
                            type: array
                          matchLabels:
                            additionalProperties:
                              type: string
                            description: matchLabels is a map of {key,value} pairs.
                              A single {key,value} in the matchLabels map is equivalent
                              to an element of matchExpressions, whose key field is
                              "key", the operator is "In", and the values array contains
                              only "value". The requirements are ANDed.
                            type: object
                        type: object
                        x-kubernetes-map-type: atomic
                    type: object
                type: object
              managed:
                default: true
                description: Managed is a flag defining whether Switch object would
                  be processed during reconciliation
                type: boolean
              scanPorts:
                default: true
                description: ScanPorts is a flag defining whether to run periodical
                  scanning on switch ports
                type: boolean
              topSpine:
                default: false
                description: TopSpine is a flag defining whether Switch is a top-level
                  spine switch
                type: boolean
            required:
            - cordon
            - managed
            - scanPorts
            - topSpine
            type: object
          status:
            description: SwitchStatus contains observed state of Switch
            properties:
              asn:
                description: ASN contains current autonomous system number defined
                  for switch
                format: int32
                type: integer
              conditions:
                description: Condition contains state of port parameters
                items:
                  description: ConditionSpec contains current condition of port parameters
                  properties:
                    lastTransitionTimestamp:
                      description: LastTransitionTimestamp reflects the last timestamp
                        when condition changed state from one to another
                      type: string
                    lastUpdateTimestamp:
                      description: LastUpdateTimestamp reflects the last timestamp
                        when condition was updated
                      type: string
                    message:
                      description: Message reflects the verbose message about the
                        reason
                      type: string
                    name:
                      description: Name reflects the name of the condition
                      enum:
                      - Initialized
                      - InterfacesOK
                      - ConfigRefOK
                      - PortParametersOK
                      - NeighborsOK
                      - LayerAndRoleOK
                      - LoopbacksOK
                      - AsnOK
                      - SubnetsOK
                      - IPAddressesOK
                      type: string
                    reason:
                      description: Reason reflects the reason of condition state
                      type: string
                    state:
                      description: State reflects the state of the condition
                      type: boolean
                  type: object
                type: array
              configRef:
                description: ConfigRef contains reference to corresponding SwitchConfig
                  object Empty ConfigRef means that there is no corresponding SwitchConfig
                  object
                properties:
                  name:
                    description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                    type: string
                type: object
                x-kubernetes-map-type: atomic
              interfaces:
                additionalProperties:
                  description: InterfaceSpec defines the state of switch's interface
                  properties:
                    direction:
                      description: Direction refers to the interface's connection
                        'direction'
                      enum:
                      - north
                      - south
                      type: string
                    fec:
                      description: FEC refers to forward error correction method which
                        should be applied on switch port
                      enum:
                      - rs
                      - none
                      type: string
                    ip:
                      description: IP contains a list of IP addresses that are assigned
                        to interface
                      items:
                        description: IPAddressSpec defines interface's ip address
                          info
                        properties:
                          address:
                            description: Address refers to the ip address value
                            type: string
                          addressFamily:
                            description: AddressFamily refers to the AF of IP address
                            enum:
                            - IPv4
                            - IPv6
                            type: string
                          extraAddress:
                            default: false
                            description: ExtraAddress is a flag defining whether address
                              was added as additional by user
                            type: boolean
                          name:
                            description: Name contains name of the referenced object
                            type: string
                          namespace:
                            description: Namespace contains namespace of the referenced
                              object
                            type: string
                        type: object
                      type: array
                    ipv4MaskLength:
                      description: IPv4MaskLength defines prefix of subnet where switch
                        port's IPv4 address should be reserved
                      format: int32
                      maximum: 32
                      minimum: 1
                      type: integer
                    ipv6Prefix:
                      description: IPv6Prefix defines prefix of subnet where switch
                        port's IPv6 address should be reserved
                      format: int32
                      maximum: 128
                      minimum: 1
                      type: integer
                    lanes:
                      description: Lanes refers to a number of lanes used by switch
                        port
                      format: int32
                      maximum: 8
                      minimum: 1
                      type: integer
                    macAddress:
                      description: MACAddress refers to the interface's hardware address
                        validation pattern
                      type: string
                    mtu:
                      description: MTU refers to maximum transmission unit value which
                        should be applied on switch port
                      format: int32
                      maximum: 65535
                      minimum: 84
                      type: integer
                    peer:
                      description: Peer refers to the info about device connected
                        to current switch port
                      properties:
                        chassisId:
                          description: ChassisID refers to the chassis identificator
                            - either MAC-address or system uuid validation pattern
                          type: string
                        name:
                          description: Name contains name of the referenced object
                          type: string
                        namespace:
                          description: Namespace contains namespace of the referenced
                            object
                          type: string
                        portDescription:
                          description: PortDescription refers to the advertised peer's
                            port description
                          type: string
                        portId:
                          description: PortID refers to the advertised peer's port
                            ID
                          type: string
                        systemName:
                          description: SystemName refers to the advertised peer's
                            name
                          type: string
                        type:
                          description: Type refers to the peer type
                          enum:
                          - machine
                          - switch
                          - router
                          - undefined
                          type: string
                      type: object
                    speed:
                      description: Speed refers to interface's speed
                      format: int32
                      type: integer
                    state:
                      description: State defines default state of switch port
                      enum:
                      - up
                      - down
                      type: string
                  required:
                  - direction
                  - macAddress
                  - speed
                  type: object
                description: Interfaces refers to switch's interfaces configuration
                type: object
              layer:
                description: Layer refers to switch's current position in connection
                  hierarchy
                format: int32
                type: integer
              loopbackAddresses:
                description: LoopbackAddresses refers to the switch's loopback addresses
                items:
                  description: IPAddressSpec defines interface's ip address info
                  properties:
                    address:
                      description: Address refers to the ip address value
                      type: string
                    addressFamily:
                      description: AddressFamily refers to the AF of IP address
                      enum:
                      - IPv4
                      - IPv6
                      type: string
                    extraAddress:
                      default: false
                      description: ExtraAddress is a flag defining whether address
                        was added as additional by user
                      type: boolean
                    name:
                      description: Name contains name of the referenced object
                      type: string
                    namespace:
                      description: Namespace contains namespace of the referenced
                        object
                      type: string
                  type: object
                type: array
              message:
                description: Message contains a brief description of the current state
                type: string
              role:
                description: Role refers to switch's role
                enum:
                - spine
                - leaf
                - edge-leaf
                type: string
              routingConfigTemplate:
                description: RoutingConfigTemplate contains the reference to the ConfigMap
                  object which contains go-template for FRR config. This field reflects
                  the corresponding field of the related SwitchConfig object.
                properties:
                  name:
                    description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                    type: string
                type: object
                x-kubernetes-map-type: atomic
              state:
                description: State is the current state of corresponding object or
                  process
                enum:
                - Initial
                - Processing
                - Ready
                - Invalid
                - Pending
                type: string
              subnets:
                description: Subnets refers to the switch's south subnets
                items:
                  description: SubnetSpec defines switch's subnet info
                  properties:
                    addressFamily:
                      description: AddressFamily refers to the AF of subnet
                      enum:
                      - IPv4
                      - IPv6
                      type: string
                    cidr:
                      description: CIDR refers to subnet CIDR validation pattern
                      type: string
                    network:
                      description: Contains information to locate the referenced object
                      properties:
                        name:
                          description: Name contains name of the referenced object
                          type: string
                        namespace:
                          description: Namespace contains namespace of the referenced
                            object
                          type: string
                      type: object
                    region:
                      description: Region refers to switch's region
                      properties:
                        availabilityZone:
                          description: AvailabilityZone refers to the switch's availability
                            zone
                          type: string
                        name:
                          description: Name refers to the switch's region
                          pattern: ^[a-z0-9]([-./a-z0-9]*[a-z0-9])?$
                          type: string
                      required:
                      - availabilityZone
                      - name
                      type: object
                    subnet:
                      description: Contains information to locate the referenced object
                      properties:
                        name:
                          description: Name contains name of the referenced object
                          type: string
                        namespace:
                          description: Namespace contains namespace of the referenced
                            object
                          type: string
                      type: object
                  type: object
                type: array
              switchPorts:
                description: SwitchPorts refers to the number of ports excluding management
                  interfaces, loopback etc.
                format: int32
                type: integer
              totalPorts:
                description: TotalPorts refers to total number of ports
                format: int32
                type: integer
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
