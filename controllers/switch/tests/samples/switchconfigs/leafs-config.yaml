apiVersion: switch.onmetal.de/v1beta1
kind: SwitchConfig
metadata:
  name: leafs-config
  namespace: onmetal
  labels:
    metalapi.onmetal.de/type-leaf: "true"
spec:
  switches:
    matchLabels:
      metalapi.onmetal.de/type: "leaf"
  portsDefaults:
    fec: "none"
    ipv4MaskLength: 30
    ipv6Prefix: 112
    mtu: 9100
    state: "up"
  ipam:
    carrierSubnets:
      matchLabels:
        ipam.onmetal.de/object-purpose: "switch-carrier"
    loopbackSubnets:
      matchLabels:
        ipam.onmetal.de/object-purpose: "switch-loopbacks"
    southSubnets:
      addressFamilies:
        ipv4: true
        ipv6: true
      labelSelector:
        matchLabels:
          ipam.onmetal.de/object-purpose: "south-subnet"
      fieldSelector:
        labelKey: "ipam.onmetal.de/object-owner"
        fieldRef:
          fieldPath: "spec.uuid"
    loopbackAddresses:
      addressFamilies:
        ipv4: true
        ipv6: true
      labelSelector:
        matchLabels:
          ipam.onmetal.de/object-purpose: "loopback"
      fieldSelector:
        labelKey: "ipam.onmetal.de/object-owner"
        fieldRef:
          fieldPath: "spec.uuid"
